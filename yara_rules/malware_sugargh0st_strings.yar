rule malware_sugargh0st_strings {
    meta:
        id = "51930498-b04a-4f13-8d14-ee975a28126e"
        version = "1.0"
        description = "Detects SugarGh0st based on strings"
        author = "Sekoia.io"
        creation_date = "2023-12-01"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "%sd.%s /c \"%s\"" wide
        $ = "[Num Lock]" wide
        $ = "#32770" wide
        $ = "]%s (%4d-%02d-%02d %02d:%02d:%02d)" wide
        
    condition:
        uint16be(0) == 0x4d5a and
        filesize < 100KB and
        all of them
}
        