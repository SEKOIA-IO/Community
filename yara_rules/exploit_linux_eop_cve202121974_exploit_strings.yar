rule exploit_linux_eop_cve202121974_exploit_strings {
    meta:
        id = "8e1fbbe5-7d51-48b4-80d5-90abff8cab9e"
        version = "1.0"
        description = "Detects CVE-2021-21974 Local Privesc exploit"
        author = "Sekoia.io"
        creation_date = "2023-12-08"
        classification = "TLP:CLEAR"
        
    strings:
        $ = ".name.replace('Thread','SLP Client'"
        $ = "print('[' + name + '] recv: ', d)"
        $ = "requests[28].put(connect())"
        $ = "[+] stack enviorn address:"
        
    condition:
        uint32be(0) == 0x7f454c46 and filesize < 1MB and all of them
}
        