rule exploit_linux_eop_pwnkit_strings {
    meta:
        id = "8637c602-62da-4983-bcb7-ba546fb2ed82"
        version = "1.0"
        description = "Detects Pwnkit Local Privesc exploit"
        author = "Sekoia.io"
        creation_date = "2023-12-08"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "CHARSET=PWNKIT"
        $ = "i/do/not/exists"
        $ = "pwnkit/pwnkit.c"
        $ = "/usr/bin/pkexec"
        $ = "SHELL=pwnkit"
        $ = "pwnkit.so"
        $ = "./pwnkit/"
        
    condition:
        uint32be(0) == 0x7f454c46 and filesize < 1MB and 2 of them
}
        