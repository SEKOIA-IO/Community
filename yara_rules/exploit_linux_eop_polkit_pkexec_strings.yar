rule exploit_linux_eop_polkit_pkexec_strings {
    meta:
        id = "de45c29e-432a-4e4f-b700-a016341d56d2"
        version = "1.0"
        description = "Detects Polkit Local Privesc exploit"
        author = "Sekoia.io"
        creation_date = "2023-12-08"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "[.] Spawning suid process (%s) ..."
        $ = "[.] Tracing midpid ..."
        $ = "PTRACE_TRACEME local root (CVE-2019-13272)"
        
    condition:
        uint32be(0) == 0x7f454c46 and filesize < 1MB and all of them
}
        