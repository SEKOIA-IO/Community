rule exploit_linux_eop_ubuntu_overlayfs_local_privesc_strings {
    meta:
        id = "5e0e73f5-4cb3-4a79-adac-578b17ed7660"
        version = "1.0"
        description = "Detects Ubuntu OverlayFS Local Privesc exploit"
        author = "Sekoia.io"
        creation_date = "2023-12-08"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "./ovlcap"
        $ = "rm -rf '%s/'"
        $ = "./ovlcap/work"
        $ = "./ovlcap/lower"
        $ = "./ovlcap/upper"
        $ = "./ovlcap/merge"
        
    condition:
        uint32be(0) == 0x7f454c46 and filesize < 1MB and all of them
}
        