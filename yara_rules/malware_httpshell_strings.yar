rule malware_httpshell_strings {
    meta:
        id = "58f25666-5dc2-4f4f-9fac-fc05d1e66945"
        version = "1.0"
        description = "Detects HTTPShell based on URL patterns"
        author = "Sekoia.io"
        creation_date = "2024-01-08"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "/api/v1/Client/Info" wide ascii
        $ = "/api/v1/Client/Download" wide ascii
        $ = "/api/v1/Client/Upload" wide ascii
        $ = "/api/v1/Client/Info" base64 base64wide
        $ = "/api/v1/Client/Download" base64 base64wide
        $ = "/api/v1/Client/Upload" base64 base64wide
        
    condition:
        3 of them and filesize < 5MB
}
        