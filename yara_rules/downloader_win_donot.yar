rule downloader_win_donot {
    meta:
        id = "31b153cc-a4b9-40a0-8bcb-ce1370645b4b"
        version = "1.0"
        description = "Detect the DoNot's downloader malware. There are big binaries in downloader strings."
        author = "Sekoia.io"
        creation_date = "2023-03-20"
        classification = "TLP:CLEAR"
        
    strings:
        // start of binary, translated: bin(bin("cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "%s""))
        $ = "001100000011000100110001001100000011000000110000001100010011000100110000001100010011000100110000001100010011000100110000001100010011"
        // other binary strings
        $ = "01010011011011110110011001110100011101110110000101110010011001010101110001001101011010010110001101110010011011110111001101101111011001100111010001011100010101110110100101101110011001000110111101110111011100110101110001000011011101010111001001110010011001010110111001110100010101100110010101110010011100110110100101101111011011100101110001010101011011100110100101101110011100110111010001100001011011000110110000000000"
        $ = "0101110001110011011110010111001101110100011001010110110100110011001100100101110001110010011101010110111001100100011011000110110000110011001100100010111001100101011110000110010100000000"
        
    condition:
        1 of them
}
        