rule win_malware_statc_downloader {
    meta:
        id = "4a2e9607-635b-4cd8-ba27-d70e0c76fd45"
        version = "1.0"
        description = "Statc Downloader powershell script. Base64 powershell"
        author = "Sekoia.io"
        creation_date = "2023-08-09"
        classification = "TLP:CLEAR"
        hash = "173ea5af2e71b6ed70abd52a5d2f4de040393a6d2ff4978bbb6e73d96742b010"
        
    strings:
        $powershell = "powershell.exe"
        // (New-Object Net.Webclient).downloadfile("https://
        $a1 = "KABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBjAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAGYAaQBsAGUAKAAiAGgAdAB0AHAAcwA6AC8A"
        $a2 = "gATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAYwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABmAGkAbABlACgAIgBoAHQAdABwAHMAOgAvA"
        $a3 = "oAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAZgBpAGwAZQAoACIAaAB0AHQAcABzADoALw"
        // invoke-expression "$env:TEMP\
        $b1 = "aQBuAHYAbwBrAGUALQBlAHgAcAByAGUAcwBzAGkAbwBuACAAIgAkAGUAbgB2ADoAVABFAE0AUABc"
        $b2 = "kAbgB2AG8AawBlAC0AZQB4AHAAcgBlAHMAcwBpAG8AbgAgACIAJABlAG4AdgA6AFQARQBNAFAAX"
        $b3 = "pAG4AdgBvAGsAZQAtAGUAeABwAHIAZQBzAHMAaQBvAG4AIAAiACQAZQBuAHYAOgBUAEUATQBQAF"
        // 1 1"; "OK";
        $c1 = "MQAgADEAIgA7ACAAIgBPAEsAIgA7"
        $c2 = "EAIAAxACIAOwAgACIATwBLACIAO"
        $c3 = "xACAAMQAiADsAIAAiAE8ASwAiAD"
        
    condition:
        $powershell at 0 and 1 of ($a*) and 1 of ($b*) and 1 of ($c*) and filesize < 1MB
}
        