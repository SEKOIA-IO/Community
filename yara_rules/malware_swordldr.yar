rule malware_swordldr {
    meta:
        id = "4068c007-50f4-4913-a352-4a40dd4e452b"
        version = "1.0"
        description = "Detects Swordldr. Maybe chunk_1 is too restrictive"
        author = "Sekoia.io"
        creation_date = "2024-09-25"
        classification = "TLP:CLEAR"
        hash = "d0cc758082e303275cbb8cd6b2048eff"
        hash = "7aa57da44718cd88f7d37b33a5d3ad74"
        
    strings:
        $ = { CC CC CC CC B0 01 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 02 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 03 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 04 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 05 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 06 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 07 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 08 C3 CC CC CC CC }
        $ = { CC CC CC CC B0 09 C3 CC CC CC CC }
        $chunk_1 = {
        48 63 44 24 40 44 8B 44 86 04 48 63 44 24 40 45 23 ?? 45 03 C0 8B 54 86 04 48 63 44 24 40 41 2B D0 41 03 ?? 89 54 86 04
        }
        
    condition:
        uint16be(0) == 0x4d5a and
        4 of them and #chunk_1 > 5
}
        