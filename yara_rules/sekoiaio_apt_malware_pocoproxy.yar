rule sekoiaio_apt_malware_pocoproxy {
    meta:
        id = "8b37e37f-339e-4f8b-b792-435096f56af0"
        version = "1.0"
        description = "Detects strings in PocoProxy"
        source = "Sekoia.io"
        creation_date = "2024-08-13"
        classification = "TLP:CLEAR"
        hash = "2b89f15012512002c656ff821bbbeca0"
        hash = "8d850fed6bb1f3b60365ed656c6791c5"
        
    strings:
        $ = "-listen" ascii fullword
        $ = "-connect" ascii fullword
        $ = "-proxy" ascii fullword
        $ = "%d-%d-%d %d:%d:%d" ascii fullword
        $ = "%S://%S:%u%S" wide
        $ = "\\r\\n[%u(%u/%u/%u/%u)]==> %S  %S>> %S:%d connect ok." wide
        $ = "\\r\\nnconnect to %S:%d faild." wide
        $ = "\\r\\nI'm listen %S:%d,welcome..." wide
        
    condition:
        uint16be(0) == 0x4d5a and
        5 of them
}
        