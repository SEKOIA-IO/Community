rule exploit_cve20191458_strings {
    meta:
        id = "0be4a550-0f0a-4596-ab32-aafaececf919"
        version = "1.0"
        description = "Detects compiled exploit for CVE-2019-1458 (Generic)"
        author = "Sekoia.io"
        creation_date = "2022-08-29"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "[-] Failed to create SploitWnd window"
        $ = "[+] ProcessCreated with pid %d!"
        $ = "[!] Exploit fail, test:0x%p,tagWND:0x%p, error:0x%lx"
        $ = "[*] tagWND: 0x%p, tagCLS:0x%p, gap:0x%llx"
        $ = "[*] Simulating alt key press"
        
    condition:
        uint16be(0) == 0x4d5a and
        filesize < 200KB and
        3 of them
}
        