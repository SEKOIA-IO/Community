rule malware_tinyshell_strings {
    meta:
        id = "51fe9986-cb33-4802-bb8d-fe3d4cdfdcc8"
        version = "1.0"
        description = "Detects TinyShell based on strings"
        author = "Sekoia.io"
        creation_date = "2024-09-04"
        classification = "TLP:CLEAR"
        hash = "fffc89ebbe6ea37072077996e27f86dd"
        hash = "59a97d4fbd3a54e991dc7e1f0451acf5"
        hash = "d7ee59eab7f703bfaf1002a39b05c7b9"
        hash = "3f2dfe47d4563919d889132b2759fd9c"
        
    strings:
        $ = "_tsh_get_file"
        $ = "_tsh_put_file"
        $ = "_tsh_runshell"
        $ = "Authentication failed."
        $ = "pel_send_msg"
        $ = "exec bash --login"
        
    condition:
        3 of them and filesize < 150KB
}
        