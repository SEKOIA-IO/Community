rule malware_remcom_strings {
    meta:
        id = "7a56d55a-2f35-41ef-b7af-259baf215a62"
        version = "1.0"
        description = "Detects RemCom based on strings"
        author = "Sekoia.io"
        creation_date = "2022-08-30"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "RemComSvc"
        $ = "RemCom_stderr"
        $ = "RemCom_stdin"
        $ = "\\\\.\\pipe\\%s%s%d"
        $ = "RemCom_stdout"
        $ = "\\\\.\\pipe\\RemCom_communicaton"
        
    condition:
        uint16be(0) == 0x4d5a and
        filesize < 1MB and
        4 of them
}
        