rule sekoiaio_exploit_linux_eop_rationallove_strings {
    meta:
        id = "e71e026e-ca2c-42b7-b552-b3fd013676db"
        version = "1.0"
        description = "Detects RationalLove Local Privesc exploit"
        source = "Sekoia.io"
        creation_date = "2023-12-08"
        classification = "TLP:CLEAR"
        
    strings:
        $ = "../x/../../AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/"
        $ = "Detected OS version: %s"
        $ = "Content-Type: text/plain; charset=UTF-8"
        
    condition:
        uint32be(0) == 0x7f454c46 and filesize < 1MB and all of them
}
        